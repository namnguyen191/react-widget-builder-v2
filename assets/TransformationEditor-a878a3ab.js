import{b as te,c as oe,a as D,e as B,f as w,_ as N,P as Y,u as ne,h as q,k as se,l as ie,j as g,m as M,n as ae,R,C as le,o as U,I as ce,q as E,t as H,Q,v as ue,J as fe,w as I,S as K,x as de,y as pe,z as ge}from"./index-55720a52.js";import{B as he,M as $e,F as xe,D as ve,d as ye,a as me,b as be,c as Se}from"./DataObject-ac618e12.js";import{C as T,F as _e,R as L}from"./CodeEditor-edc80639.js";function je(l){return oe("MuiDialog",l)}const Ce=te("MuiDialog",["root","scrollPaper","scrollBody","container","paper","paperScrollPaper","paperScrollBody","paperWidthFalse","paperWidthXs","paperWidthSm","paperWidthMd","paperWidthLg","paperWidthXl","paperFullWidth","paperFullScreen"]),z=Ce,Oe=D.createContext({}),Je=Oe,Ne=["aria-describedby","aria-labelledby","BackdropComponent","BackdropProps","children","className","disableEscapeKeyDown","fullScreen","fullWidth","maxWidth","onBackdropClick","onClose","open","PaperComponent","PaperProps","scroll","TransitionComponent","transitionDuration","TransitionProps"],We=B(he,{name:"MuiDialog",slot:"Backdrop",overrides:(l,u)=>u.backdrop})({zIndex:-1}),De=l=>{const{classes:u,scroll:b,maxWidth:h,fullWidth:j,fullScreen:a}=l,r={root:["root"],container:["container",`scroll${w(b)}`],paper:["paper",`paperScroll${w(b)}`,`paperWidth${w(String(h))}`,j&&"paperFullWidth",a&&"paperFullScreen"]};return ae(r,je,u)},we=B($e,{name:"MuiDialog",slot:"Root",overridesResolver:(l,u)=>u.root})({"@media print":{position:"absolute !important"}}),ke=B("div",{name:"MuiDialog",slot:"Container",overridesResolver:(l,u)=>{const{ownerState:b}=l;return[u.container,u[`scroll${w(b.scroll)}`]]}})(({ownerState:l})=>N({height:"100%","@media print":{height:"auto"},outline:0},l.scroll==="paper"&&{display:"flex",justifyContent:"center",alignItems:"center"},l.scroll==="body"&&{overflowY:"auto",overflowX:"hidden",textAlign:"center","&:after":{content:'""',display:"inline-block",verticalAlign:"middle",height:"100%",width:"0"}})),Ee=B(Y,{name:"MuiDialog",slot:"Paper",overridesResolver:(l,u)=>{const{ownerState:b}=l;return[u.paper,u[`scrollPaper${w(b.scroll)}`],u[`paperWidth${w(String(b.maxWidth))}`],b.fullWidth&&u.paperFullWidth,b.fullScreen&&u.paperFullScreen]}})(({theme:l,ownerState:u})=>N({margin:32,position:"relative",overflowY:"auto","@media print":{overflowY:"visible",boxShadow:"none"}},u.scroll==="paper"&&{display:"flex",flexDirection:"column",maxHeight:"calc(100% - 64px)"},u.scroll==="body"&&{display:"inline-block",verticalAlign:"middle",textAlign:"left"},!u.maxWidth&&{maxWidth:"calc(100% - 64px)"},u.maxWidth==="xs"&&{maxWidth:l.breakpoints.unit==="px"?Math.max(l.breakpoints.values.xs,444):`max(${l.breakpoints.values.xs}${l.breakpoints.unit}, 444px)`,[`&.${z.paperScrollBody}`]:{[l.breakpoints.down(Math.max(l.breakpoints.values.xs,444)+32*2)]:{maxWidth:"calc(100% - 64px)"}}},u.maxWidth&&u.maxWidth!=="xs"&&{maxWidth:`${l.breakpoints.values[u.maxWidth]}${l.breakpoints.unit}`,[`&.${z.paperScrollBody}`]:{[l.breakpoints.down(l.breakpoints.values[u.maxWidth]+32*2)]:{maxWidth:"calc(100% - 64px)"}}},u.fullWidth&&{width:"calc(100% - 64px)"},u.fullScreen&&{margin:0,width:"100%",maxWidth:"100%",height:"100%",maxHeight:"none",borderRadius:0,[`&.${z.paperScrollBody}`]:{margin:0,maxWidth:"100%"}})),Te=D.forwardRef(function(u,b){const h=ne({props:u,name:"MuiDialog"}),j=q(),a={enter:j.transitions.duration.enteringScreen,exit:j.transitions.duration.leavingScreen},{"aria-describedby":r,"aria-labelledby":O,BackdropComponent:J,BackdropProps:e,children:n,className:t,disableEscapeKeyDown:o=!1,fullScreen:i=!1,fullWidth:s=!1,maxWidth:f="sm",onBackdropClick:x,onClose:v,open:d,PaperComponent:$=Y,PaperProps:y={},scroll:c="paper",TransitionComponent:p=xe,transitionDuration:S=a,TransitionProps:m}=h,C=se(h,Ne),_=N({},h,{disableEscapeKeyDown:o,fullScreen:i,fullWidth:s,maxWidth:f,scroll:c}),W=De(_),P=D.useRef(),Z=k=>{P.current=k.target===k.currentTarget},ee=k=>{P.current&&(P.current=null,x&&x(k),v&&v(k,"backdropClick"))},F=ie(O),re=D.useMemo(()=>({titleId:F}),[F]);return g.jsx(we,N({className:M(W.root,t),closeAfterTransition:!0,components:{Backdrop:We},componentsProps:{backdrop:N({transitionDuration:S,as:J},e)},disableEscapeKeyDown:o,onClose:v,open:d,ref:b,onClick:ee,ownerState:_},C,{children:g.jsx(p,N({appear:!0,in:d,timeout:S,role:"presentation"},m,{children:g.jsx(ke,{className:M(W.container),onMouseDown:Z,ownerState:_,children:g.jsx(Ee,N({as:$,elevation:24,role:"dialog","aria-describedby":r,"aria-labelledby":F},y,{className:M(W.paper,y.className),ownerState:_,children:g.jsx(Je.Provider,{value:re,children:n})}))})}))}))}),Be=Te;var G={exports:{}};(function(l,u){(function(){var b,h={is_template:function(e){var n=/\{\{(.+)\}\}/g;return n.test(e)},is_array:function(e){return Array.isArray(e)||!!e&&typeof e=="object"&&typeof e.length=="number"&&(e.length===0||e.length>0&&e.length-1 in e)},resolve:function(e,n,t){if(n&&n.length>0){var o=Function("new_val","with(this) {this"+n+"=new_val; return this;}").bind(e);return o(t)}else return e=t,e}},j={run:function(e,n){for(var t=0;t<e.length;t++){var o=e[t],i=Object.keys(o),s=i[0],f=a.tokenize(s);if(f.name==="#if"||f.name==="#elseif"){var x=f.expression,v=a.fillout(n,"{{"+x+"}}");if(v==="{{"+x+"}}")return e;if(v)return a.run(o[s],n)}else return a.run(o[s],n)}return null},is:function(e){if(!h.is_array(e)||e.length===0)return!1;for(var n=!0,t=0;t<e.length;t++){var o=e[0];if(typeof o!="object"){n=!1;break}if(Object.keys(o).length!==1){n=!1;break}}if(!n)return!1;var i=e[0],s;for(var f in i)if(s=a.tokenize(f),!s||!s.name||!s.expression||s.expression.length===0||s.name.toLowerCase()!=="#if")return!1;if(e.length===1)return!0;for(var x=!0,v=1;v<e.length-1;v++){var d=e[v];for(var $ in d)if(s=a.tokenize($),s.name.toLowerCase()!=="#elseif"){x=!1;break}}if(!x)return!1;var y=e[e.length-1];for(var c in y)if(s=a.tokenize(c),["#else","#elseif"].indexOf(s.name.toLowerCase())===-1)return!1;return!0}},a={transform:function(e,n,t,o){var i=null;/#include/.test(JSON.stringify(e))&&(i=function(x,v){return/#include/.test(x)||/#include/.test(v)});var s;if(t){var f=r.select(e,i,o).transform(n,o).root();s=r.select(n,null,o).inject(t,o).transformWith(f,o).root()}else s=r.select(e,i,o).transform(n,o).root();return o?JSON.stringify(s):s},tokenize:function(e){var n=/\{\{(.+)\}\}/g;e=e.replace(n,"$1");var t=e.trim().split(" "),o;if(t.length>0&&t[0][0]==="#"){o=t.shift();var i=t.join(" ");return{name:o,expression:i}}return null},run:function(e,n){var t,o;if(typeof e=="string")if(h.is_template(e)){var i=/\{\{([ ]*#include)[ ]*([^ ]*)\}\}/g;i.test(e)?(o=a.tokenize(e),o.expression?t=a.fillout(n,"{{"+o.expression+"}}",!0):t=e):t=a.fillout(n,e)}else t=e;else if(h.is_array(e))if(j.is(e))t=j.run(e,n);else{t=[];for(var s=0;s<e.length;s++){var f=a.run(e[s],n);f&&t.push(f)}}else if(Object.prototype.toString.call(e)==="[object Object]"){t={};var x=/\{\{([ ]*#include)[ ]*(.*)\}\}/,v=Object.keys(e).filter(function(C){return x.test(C)});v.length>0&&(o=a.tokenize(v[0]),o.expression?t=a.fillout(e[v[0]],"{{"+o.expression+"}}",!0):t=e[v[0]]);for(var d in e)if(h.is_template(d))if(o=a.tokenize(d),o){if(o.name!=="#include"){if(o.name==="#concat")h.is_array(e[d])&&(t=[],e[d].forEach(function(C){var _=a.run(C,n);t=t.concat(_)}),/\{\{(.*?)\}\}/.test(JSON.stringify(t))&&(t=e));else if(o.name==="#merge")h.is_array(e[d])&&(t={},e[d].forEach(function(C){var _=a.run(C,n);for(var W in _)t[W]=_[W]}),typeof n=="object"?delete t.$index:(delete String.prototype.$index,delete Number.prototype.$index,delete Function.prototype.$index,delete Array.prototype.$index,delete Boolean.prototype.$index));else if(o.name==="#each"){var $=a.fillout(n,"{{"+o.expression+"}}",!0);if($&&h.is_array($)){t=[];for(var y=0;y<$.length;y++){typeof $[y]=="object"?$[y].$index=y:(String.prototype.$index=y,Number.prototype.$index=y,Function.prototype.$index=y,Array.prototype.$index=y,Boolean.prototype.$index=y);var c=a.run(e[d],$[y]);typeof $[y]=="object"?delete $[y].$index:(delete String.prototype.$index,delete Number.prototype.$index,delete Function.prototype.$index,delete Array.prototype.$index,delete Boolean.prototype.$index),c&&t.push(c)}}else t=e}}}else{var p=a.fillout(n,d),S=a.fillout(n,e[d]);p!==void 0&&S!==void 0&&(t[p]=S)}else if(typeof e[d]=="string")if(o=a.tokenize(e[d]),o&&o.name==="#?"){var m=a.fillout(n,"{{"+o.expression+"}}");m==="{{"+o.expression+"}}"||!m||(t[d]=m)}else{var f=a.run(e[d],n);f!==void 0&&(t[d]=f)}else{var f=a.run(e[d],n);f!==void 0&&(t[d]=f)}}else return e;return t},fillout:function(e,n,t){var o=n;if(h.is_template(n)){var i=/\{\{(.*?)\}\}/g,s=n.match(i);if(s)if(t)o=a._fillout({variable:s[0],data:e,template:null});else for(var f=0;f<s.length;f++){var x=s[f];o=a._fillout({variable:x,data:e,template:o})}else return o}return o},_fillout:function(e){var n=/\{\{(.*?)\}\}/g,t=/^\{\{((?!\}\}).)*\}\}$/,o=e.variable,i=e.data,s=e.template;try{var f=o.replace(n,"$1");if(i){var x,v=typeof i;["number","string","array","boolean","function"].indexOf(v===-1)&&(i.$root=b);var d=/function\([ ]*\)[ ]*\{(.*)\}[ ]*$/g.exec(f);d?x=Function("with(this) {"+d[1]+"}").bind(i):/\breturn [^;]+;?[ ]*$/.test(f)&&/return[^}]*$/.test(f)?x=Function("with(this) {"+f+"}").bind(i):x=Function("with(this) {return ("+f+")}").bind(i);var $=x();return delete i.$root,$&&($=$.valueOf()),typeof $>"u"?s:$?s?t.test(s)?$:s.replace(o,$):$:s?t.test(s)?$:s.replace(o,""):""}return s}catch{return s}}},r={$val:null,$selected:[],$injected:[],$progress:null,exec:function(e,n,t){if(typeof e!="string"){if(h.is_array(e))for(var o=0;o<e.length;o++)r.exec(e[o],n+"["+o+"]",t);else for(var i in e)if(i!=="$root"){if(t(i,e[i])){var s=r.$selected.length;r.$selected.push({index:s,key:i,path:n,object:e,value:e[i]})}r.exec(e[i],n+'["'+i+'"]',t)}}},inject:function(e,n){r.$injected=e;try{n&&(r.$injected=JSON.parse(e))}catch{}return Object.keys(r.$injected).length>0&&r.select(r.$injected),r},select:function(e,n,t){var o=e;try{t&&(o=JSON.parse(e))}catch{}return n?(r.$selected=[],r.exec(o,"",n)):r.$selected=null,o&&(h.is_array(o)||typeof o=="object")?(r.$progress||(h.is_array(o)?(r.$val=[],r.$selected_root=[]):(r.$val={},r.$selected_root={})),Object.keys(o).forEach(function(i){r.$val[i]=o[i],r.$selected_root[i]=o[i]})):(r.$val=o,r.$selected_root=o),r.$progress=!0,r},transformWith:function(e,n){r.$parsed=[],r.$progress=null;var t=e;try{n&&(t=JSON.parse(e))}catch{}if(r.$template_root=t,String.prototype.$root=r.$selected_root,Number.prototype.$root=r.$selected_root,Function.prototype.$root=r.$selected_root,Array.prototype.$root=r.$selected_root,Boolean.prototype.$root=r.$selected_root,b=r.$selected_root,r.$selected&&r.$selected.length>0)r.$selected.sort(function(i,s){return s.path.length-i.path.length}).forEach(function(i){var s=a.run(t,i.object);r.$selected_root=h.resolve(r.$selected_root,i.path,s),i.object=s}),r.$selected.sort(function(i,s){return i.index-s.index});else{var o=a.run(t,r.$selected_root);r.$selected_root=h.resolve(r.$selected_root,"",o)}return delete String.prototype.$root,delete Number.prototype.$root,delete Function.prototype.$root,delete Array.prototype.$root,delete Boolean.prototype.$root,r},transform:function(e,n){r.$parsed=[],r.$progress=null;var t=e;try{n&&(t=JSON.parse(e))}catch{}if(r.$template_root=r.$selected_root,String.prototype.$root=t,Number.prototype.$root=t,Function.prototype.$root=t,Array.prototype.$root=t,Boolean.prototype.$root=t,b=t,r.$selected&&r.$selected.length>0)r.$selected.sort(function(i,s){return s.path.length-i.path.length}).forEach(function(i){var s=a.run(i.object,t);r.$template_root=h.resolve(r.$template_root,i.path,s),r.$selected_root=r.$template_root,i.object=s}),r.$selected.sort(function(i,s){return i.index-s.index});else{var o=a.run(r.$selected_root,t);r.$template_root=h.resolve(r.$template_root,"",o),r.$selected_root=r.$template_root}return delete String.prototype.$root,delete Number.prototype.$root,delete Function.prototype.$root,delete Array.prototype.$root,delete Boolean.prototype.$root,r},objects:function(){return r.$progress=null,r.$selected?r.$selected.map(function(e){return e.object}):[r.$selected_root]},keys:function(){return r.$progress=null,r.$selected?r.$selected.map(function(e){return e.key}):Array.isArray(r.$selected_root)?Object.keys(r.$selected_root).map(function(e){return parseInt(e)}):Object.keys(r.$selected_root)},paths:function(){return r.$progress=null,r.$selected?r.$selected.map(function(e){return e.path}):Array.isArray(r.$selected_root)?Object.keys(r.$selected_root).map(function(e){return"["+e+"]"}):Object.keys(r.$selected_root).map(function(e){return'["'+e+'"]'})},values:function(){return r.$progress=null,r.$selected?r.$selected.map(function(e){return e.value}):Object.values(r.$selected_root)},root:function(){return r.$progress=null,r.$selected_root}},O=JSON.stringify;JSON.stringify=function(e,n,t){var o=typeof e;return["number","string","boolean"].indexOf(o)!==-1||n?O(e,n,t):O(e,function(i,s){if(!(r.$injected&&r.$injected.length>0&&r.$injected.indexOf(i)!==-1)&&!(i==="$root"||i==="$index"))return typeof s=="function"?"("+s.toString()+")":s},t)};{var J={TRANSFORM:a,transform:a,SELECT:r,Conditional:j,Helper:h,inject:r.inject,select:r.select,transform:a.transform};l.exports&&(l.exports=J)}})()})(G);var V=G.exports;const Re="_container_26rc8_1",Ae="_dataButton_26rc8_9",Pe="_editorsContainer_26rc8_14",Fe="_codeEditorContainer_26rc8_21",Me="_transformResult_26rc8_21",A={container:Re,dataButton:Ae,editorsContainer:Pe,codeEditorContainer:Fe,transformResult:Me},X="45vw",Ie=B("div")(({theme:l})=>({display:"flex",alignItems:"center",padding:l.spacing(0,1),...l.mixins.toolbar,justifyContent:"flex-start"})),Le={template:"{}",stringifyTemplate:'"{}"',data:"{}",result:"{}"},ze=H(Q.error,1e3),Ke=()=>{const l=q(),[u,b]=R.useState(!1),[h,j]=R.useState(!1),[a,r]=R.useState(""),O=R.useRef(""),J=D.useRef(null),[e,n]=D.useState(Le),t=c=>{let p=de(c);return p=pe(p),p=ge(p),p},o=()=>{b(!0)},i=()=>{b(!1)},s=H(async c=>{if(c)try{const p=JSON.parse(e.data),S=JSON.parse(c),m=V.select(p).transformWith(S).root(),C=await I(JSON.stringify(m),E);n(_=>({data:_.data,template:c,stringifyTemplate:t(JSON.stringify(c)),result:C}))}catch{}},1e3),f=c=>{if(!c)return;let p={};try{p=JSON.parse(JSON.parse(c))}catch(m){m instanceof Error&&ze(m.message),typeof m=="string"&&Q.error(m)}const S=V.select(e.data).transformWith(p,null,!0).root();n(m=>({stringifyTemplate:c,template:JSON.stringify(p),data:m.data,result:JSON.stringify(S)}))},x=H(async c=>{if(!c)return;const p=JSON.parse(c),S=JSON.parse(e.template),m=V.select(p).transformWith(S).root(),C=await I(JSON.stringify(m),E);n(_=>({..._,data:c,result:C}))},2e3),v=()=>{const c=JSON.parse(e.data);let p="";for(const[S,m]of Object.entries(c))p+=`this.${S} = ${JSON.stringify(m)};`;return{language:"javascript",data:p}},d=async()=>{if(j(!1),!J.current)return;const{code:c}=await ue(O.current,{sourceMap:!1,mangle:!1,compress:!1}),p=fe(c??""),m={range:J.current.getSelection(),text:p,forceMoveMarkers:!0};J.current.executeEdits("JsEditorDialog",[m])},$={name:"Edit JS",callBack:async(c,p)=>{let S="";try{S=await I(K(c),U)}catch{console.warn("JS syntax error detected"),S=K(c)}O.current=c,r(S),j(!0),J.current=p}},y=c=>{c&&(O.current=c)};return g.jsxs("div",{className:A.container,children:[g.jsx(Be,{open:h,onClose:d,fullScreen:!0,style:{display:"flex",justifyContent:"center",padding:"5rem"},children:g.jsx(le,{style:{height:"100%",width:"80vw",padding:0},children:g.jsx(T,{initialValue:a,prettierConfigOverride:U,onChange:y,addToAutoComplete:v()})})}),g.jsxs(ve,{sx:{width:X,flexShrink:0,"& .MuiDrawer-paper":{width:X}},variant:"persistent",anchor:"right",open:u,children:[g.jsx(Ie,{children:g.jsx(ce,{onClick:i,children:l.direction==="rtl"?g.jsx(ye,{}):g.jsx(me,{})})}),g.jsx(be,{}),g.jsx(T,{initialValue:e.data,onChange:x,language:"json",prettierConfigOverride:E})]}),g.jsxs(_e,{variant:"extended",className:A.dataButton,onClick:o,children:[g.jsx(Se,{sx:{mr:1}}),"Data"]}),g.jsxs("div",{className:A.editorsContainer,children:[g.jsx(L,{defaultSize:{height:"60vh",width:"47vw"},className:A.codeEditorContainer,children:g.jsx(T,{initialValue:e.template,language:"json",prettierConfigOverride:E,onChange:s,actionOnHighlightedText:$})}),g.jsx(L,{defaultSize:{height:"60vh",width:"47vw"},children:g.jsx(T,{initialValue:e.result,prettierConfigOverride:E,language:"json",readonly:!0})}),g.jsx(L,{defaultSize:{height:"25vh",width:"95vw"},children:g.jsx(T,{enableFormat:!1,language:"text",initialValue:e.stringifyTemplate,onChange:f})})]})]})};export{Ke as default};
